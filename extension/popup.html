<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Vaulty Agent</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="wrap">
      <!-- Tab Navigation -->
      <div class="tabs">
        <button class="tab active" data-tab="agent">Agent</button>
        <button class="tab" data-tab="logs">Logs</button>
        <button class="tab" data-tab="profile">Profile</button>
        <button class="tab" data-tab="behavior">Behavior</button>
        <button class="tab" data-tab="settings">Settings</button>
      </div>

      <!-- Agent Tab -->
      <div id="tab-agent" class="tab-content active">
        <label class="label">Start URL</label>
        <input id="url" class="input" placeholder="https://example.com/apply" />

        <div class="row">
          <label class="radio"><input type="radio" name="mode" value="live" checked /> Live</label>
          <label class="radio"><input type="radio" name="mode" value="background" /> Background</label>
        </div>

        <button id="start" class="btn">Start Agent</button>
        <button id="stop" class="btn secondary">Stop</button>

        <hr />

        <div class="status">
          <div><b>Job:</b> <span id="jobId">â€”</span></div>
          <div><b>Status:</b> <span id="status">idle</span></div>
          <div><b>Step:</b> <span id="step">0</span></div>
        </div>

        <div id="approval" class="approval hidden">
          <div class="warn">âš ï¸ Approval required before clicking submit-like button.</div>
          <button id="approve" class="btn danger">Approve & Continue</button>
        </div>

        <div id="passwordRequest" class="verify hidden">
          <div class="warn">ğŸ” Password required for login</div>
          <input id="passwordInput" class="input" type="password" placeholder="Enter password" />
          <button id="sendPassword" class="btn">Send Password</button>
        </div>

        <div id="otpRequest" class="verify hidden">
          <div class="warn">ğŸ“± Verification code required</div>
          <input id="otp" class="input" placeholder="Enter OTP / Code" />
          <button id="sendOtp" class="btn">Send Code</button>
        </div>
      </div>

      <!-- Logs Tab -->
      <div id="tab-logs" class="tab-content">
        <div class="logs-header">
          <div class="section-title">ğŸ§  Agent Thinking</div>
          <div class="logs-actions">
            <button id="refreshLogs" class="btn-small">â†» Refresh</button>
            <button id="clearLogs" class="btn-small secondary">Clear</button>
            <button id="exportLogs" class="btn-small secondary">Export</button>
          </div>
        </div>
        <p class="hint">View the full conversation between the agent and the LLM planner.</p>
        
        <div id="logsContainer" class="logs-container">
          <div class="logs-empty">No logs yet. Start the agent to see thinking.</div>
        </div>
      </div>

      <!-- Profile Tab -->
      <div id="tab-profile" class="tab-content">
        
        <!-- Login Credentials Section -->
        <div class="section-title">ğŸ” Login Credentials</div>
        <p class="hint">Used for account creation and login forms</p>
        
        <label class="label">Email (Primary)</label>
        <input id="profile-email" class="input" type="email" placeholder="john@example.com" />

        <label class="label">Password</label>
        <input id="profile-password" class="input" type="password" placeholder="Your preferred password" />
        <p class="hint">Stored locally in your browser. Never sent to servers.</p>

        <div class="row">
          <label class="checkbox">
            <input type="checkbox" id="profile-preferOAuth" />
            Prefer "Login with Google" when available
          </label>
        </div>

        <!-- Personal Info Section -->
        <div class="section-title">ğŸ‘¤ Personal Information</div>
        
        <div class="row">
          <div class="field">
            <label class="label">First Name</label>
            <input id="profile-firstName" class="input" placeholder="John" />
          </div>
          <div class="field">
            <label class="label">Last Name</label>
            <input id="profile-lastName" class="input" placeholder="Doe" />
          </div>
        </div>

        <label class="label">Phone</label>
        <input id="profile-phone" class="input" type="tel" placeholder="+1 555 123 4567" />

        <!-- Address Section -->
        <div class="section-title">ğŸ“ Address</div>

        <label class="label">Street Address</label>
        <input id="profile-street" class="input" placeholder="123 Main St" />

        <label class="label">Apt/Suite (optional)</label>
        <input id="profile-street2" class="input" placeholder="Apt 4B" />

        <div class="row">
          <div class="field">
            <label class="label">City</label>
            <input id="profile-city" class="input" placeholder="San Francisco" />
          </div>
          <div class="field">
            <label class="label">State</label>
            <input id="profile-state" class="input" placeholder="CA" />
          </div>
        </div>

        <div class="row">
          <div class="field">
            <label class="label">ZIP Code</label>
            <input id="profile-zipCode" class="input" placeholder="94102" />
          </div>
          <div class="field">
            <label class="label">Country</label>
            <input id="profile-country" class="input" placeholder="USA" />
          </div>
        </div>

        <!-- Professional Section -->
        <div class="section-title">ğŸ’¼ Professional</div>

        <label class="label">Current Company</label>
        <input id="profile-company" class="input" placeholder="Acme Inc" />

        <label class="label">Job Title</label>
        <input id="profile-jobTitle" class="input" placeholder="Software Engineer" />

        <label class="label">LinkedIn URL</label>
        <input id="profile-linkedIn" class="input" placeholder="https://linkedin.com/in/johndoe" />

        <label class="label">GitHub URL</label>
        <input id="profile-github" class="input" placeholder="https://github.com/johndoe" />

        <label class="label">Website / Portfolio</label>
        <input id="profile-website" class="input" placeholder="https://johndoe.com" />

        <!-- Resume Section -->
        <div class="section-title">ğŸ“„ Resume / CV Data</div>
        <p class="hint">Paste your resume as plain text or JSON. The agent will use this to fill work history, skills, education, and bio fields.</p>

        <label class="label">Resume (Text or JSON)</label>
        <textarea id="profile-resume" class="input textarea" placeholder='Paste your resume text here, or use JSON format:

{
  "bio": "Experienced software engineer...",
  "summary": "5+ years of experience...",
  "skills": ["JavaScript", "Python", "React"],
  "experiences": [
    {
      "company": "Acme Inc",
      "title": "Senior Engineer",
      "startDate": "2020-01",
      "current": true,
      "description": "Led development..."
    }
  ],
  "education": [
    {
      "school": "MIT",
      "degree": "BS",
      "field": "Computer Science",
      "endDate": "2018"
    }
  ],
  "certifications": ["AWS Certified"],
  "languages": ["English", "Spanish"]
}'></textarea>

        <button id="saveProfile" class="btn">ğŸ’¾ Save Profile</button>
        <button id="clearProfile" class="btn secondary">Clear All</button>
        
        <div id="profileStatus" class="status-msg"></div>
      </div>

      <!-- Settings Tab -->
      <div id="tab-settings" class="tab-content">
        <div class="section-title">ğŸŒ API Configuration</div>

        <label class="label">Backend URL</label>
        <input id="settings-apiBase" class="input" placeholder="http://localhost:3000" />

        <div class="section-title">ğŸ¤– LLM Provider</div>
        <p class="hint">The backend uses its own LLM config. Only set these if you want direct calls from the extension.</p>

        <label class="label">Provider</label>
        <select id="settings-llmProvider" class="input">
          <option value="">Use Backend Default</option>
          <option value="openai">OpenAI</option>
          <option value="anthropic">Anthropic</option>
          <option value="openrouter">OpenRouter</option>
          <option value="ollama">Ollama (Local)</option>
        </select>

        <label class="label">API Key</label>
        <input id="settings-llmApiKey" class="input" type="password" placeholder="sk-..." />

        <label class="label">Model (optional)</label>
        <input id="settings-llmModel" class="input" placeholder="gpt-4o-mini" />

        <div id="ollamaSettings" class="hidden">
          <label class="label">Ollama URL</label>
          <input id="settings-ollamaUrl" class="input" placeholder="http://localhost:11434" />
        </div>

        <button id="saveSettings" class="btn">ğŸ’¾ Save Settings</button>
        
        <div id="settingsStatus" class="status-msg"></div>

        <hr />

        <div class="section-title">ğŸ“Š Debug Info</div>
        <button id="exportProfile" class="btn secondary">Export Profile JSON</button>
        <button id="viewStorage" class="btn secondary">View Storage</button>
      </div>

      <!-- Behavior Tab -->
      <div id="tab-behavior" class="tab-content">
        <div class="section-title">ğŸ§  Agent Behavior</div>
        <p class="hint">Control safety limits and runtime behavior.</p>

        <div class="row">
          <label class="checkbox">
            <input type="checkbox" id="behavior-autopilotEnabled" />
            Autopilot (bypass approvals and auto-submit)
          </label>
        </div>
        <p class="hint">When enabled, the agent will not pause for approval and will attempt to submit applications automatically.</p>

        <div class="row">
          <label class="checkbox">
            <input type="checkbox" id="behavior-capEnabled" />
            Enable step cap (safety stop)
          </label>
        </div>

        <label class="label">Max Steps</label>
        <input id="behavior-maxSteps" class="input" type="number" min="1" step="1" placeholder="40" />
        <p class="hint">If disabled, the agent will not stop due to step count.</p>

        <button id="saveBehavior" class="btn">ğŸ’¾ Save Behavior</button>
        <div id="behaviorStatus" class="status-msg"></div>

        <hr />

        <div class="section-title">Notes</div>
        <p class="hint">
          Even with the cap disabled, the agent still pauses for approval, OTP/captcha, and stops on fatal errors.
        </p>
      </div>
    </div>

    <script src="popup.js"></script>
  </body>
</html>
